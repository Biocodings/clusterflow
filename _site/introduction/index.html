<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title> Introduction |  Cluster Flow</title>
	<meta name="description" content="A pipelining tool to automate and standardise bioinformatics analyses on cluster environments"/>
	<meta name="author" content="Phil Ewels"/>
	
	<!-- Bootstrap and Google Fonts -->
	<link href="/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic' rel='stylesheet' type='text/css'>
	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
	<![endif]-->
	
	<!-- Site Stylesheet -->
	<link rel="stylesheet" href="/style.css">
</head>
<body>

<header>
	<section class="logo">
		<h1><a href="/"><img src="/resources/img/CF_logo.png" title="Cluster Flow"></a></h1>
		<p>A pipelining tool to automate and standardise bioinformatics analyses on cluster environments.</p>
	</section>
	<section class="download">
		<p>
			<a class="btn btn-default" href="/" title="Download Cluster Flow"><i class="glyphicon glyphicon-folder-open"></i> &nbsp; &nbsp; Download Cluster Flow</a>
			<a class="text-link" href="" title="Download Current Cluster Flow Development Version" onclick="return(confirm('This code is currently in development and there\'s a good chance that it will contain bugs - are you sure you don\'t want the stable release?'));"><i class="glyphicon glyphicon-folder-open"></i> &nbsp; &nbsp; Download devel version</a>
			<a class="text-link" href="/" title="View on GitHub"><img src="/resources/img/GitHub-Mark/PNG/GitHub-Mark-Light-16px.png" title="View on GitHub"> &nbsp; View on GitHub</a>
		</p>
	</section>
	<nav id="nav">
		<ul>
			<li><a href="/introduction/">Introduction</a></li>
			<li><a href="/installation/">Installation Instructions</a></li>
			<li><a href="/usage/">General Usage</a></li>
			<li><a href="/cl_reference/">Command Line Reference</a></li>
			<li><a href="/writing_pipelines_modules/">Writing Pipelines &amp; Modules</a></li>
			<li><a href="/troubleshooting/">Troubleshooting</a></li>
		</ul>
	</nav>
	<section class="credits">
		<p>Cluster Flow was written by <a href="http://phil.ewels.co.uk" target="_blank">Phil Ewels</a> whilst working at the <a href="http://www.babraham.ac.uk" target="_blank">Babraham Institute</a>. He now maintains it from <a href="http://www.scilifelab.se" target="_blank">SciLifeLab</a> in Stockholm, Sweden.</p>
		<p class="logos">
			<a href="http://www.babraham.ac.uk" target="_blank"><img src="/resources/img/Babraham_logo.png" title="Babraham Institute"></a>
			<a href="http://www.scilifelab.se" target="_blank"><img src="/resources/img/SciLifeLab_logo.png" title="SciLifeLab"></a>
		</p>
		<p>This documentation is written using <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and hosted using <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.</p>
	</section>
</header>

<div class="mainpage mainpage-toc">
	<h1 class="page-title">Introduction</h1>
	<h1 id="what_is_cluster_flow">What is Cluster Flow?</h1>

<p>Cluster Flow is simple package to run pipelines in a cluster environment. It is comprised of several layers:</p>

<ul>
<li><code>cf</code>
<ul>
<li>The main cluster flow command. This is called to initiate a new pipeline run.</li>
</ul>
</li>

<li>Pipelines
<ul>
<li>Protocols that describe a series of modules to be run, along with any parameters</li>
</ul>
</li>

<li>Modules
<ul>
<li>The instructions for an individual task. These can be written in any language but must conform to a common API, described within this document.</li>
</ul>
</li>

<li>Runs
<ul>
<li>Created from the pipeline template for each file. Specifies configuration variables and traces output filenames.</li>
</ul>
</li>
</ul>

<p>Cluster Flow will set off multiple queued jobs on the cluster with queue dependencies as defined in the pipeline.</p>

<h1 id="how_does_cluster_flow_work">How does Cluster Flow work?</h1>

<p>A typical Cluster Flow run will work as follows:</p>

<ul>
<li>Pipelines and modules are written for Cluster Flow</li>

<li>The <code>cf</code> command is run, initiating a pipeline with a set of files</li>

<li>CF decides on a number of runs, each with a set of input files or URLs</li>

<li>Input filenames are checked to make sure that they all have the same file extension</li>

<li>If input files are fastq, CF tries to work out whether they’re paired end or single end from the filenames. It dies with an error if it finds a mixture</li>

<li>CF checks that the files exist (unless they’re URLs) and parses the pipeline file</li>

<li>A run file is created for each run. This contains the configuration variables, a copy of the pipeline used and the starting filenames with the associated id <code>start_000</code></li>

<li>CF submits all of the jobs to the cluster
<ul>
<li>Each module in each run has its own cluster job</li>

<li>Jobs are submitted with dependencies so that they execute in the order specified by the pipeline</li>
</ul>
</li>

<li>Main CF program finishes and exits</li>

<li>Modules execute, using the run file and the previous job ID to find their input files</li>

<li>STDERR is appended to the log files.
<ul>
<li>Commands should print their commands with <code>###CFCMD</code> prepended</li>

<li>Important messages should start with <code>###CF</code></li>
</ul>
</li>

<li>Upon the completion of each module, the filenames of any resulting output files are appended to the run file, along with the job ID so that the next module can find them</li>

<li>Once all pipeline modules have finished, core cluster flow notification modules run
<ul>
<li>These clean up the output file and send e-mails</li>
</ul>
</li>
</ul>
</div>

<aside class="sidebar">
	<nav id="subnav">
		<h3>Table of Contents</h3>
		<div class="toc"></div>
	</nav>
</aside>

	<footer>
		<section class="credits">
			<p>Cluster Flow was written by <a href="http://phil.ewels.co.uk" target="_blank">Phil Ewels</a> whilst working at the <a href="http://www.babraham.ac.uk" target="_blank">Babraham Institute</a>. He now maintains it from <a href="http://www.scilifelab.se" target="_blank">SciLifeLab</a> in Stockholm, Sweden.</p>
			<p class="logos">
				<a href="http://www.babraham.ac.uk" target="_blank"><img src="/resources/img/Babraham_logo.png" title="Babraham Institute"></a>
				<a href="http://www.scilifelab.se" target="_blank"><img src="/resources/img/SciLifeLab_logo.png" title="SciLifeLab"></a>
			</p>
			<p>This documentation is written using <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> and hosted using <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.</p>
		</section>
	</footer>
	<!-- jQuery & Boostrap -->
	<script src="/resources/jquery-1.11.1.min.js"></script>
	<script src="/resources/bootstrap/js/bootstrap.min.js"></script>
	<!-- Auto TOC Generator -->
	<script src="/resources/jekyll-table-of-contents-master/toc.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
		    $('.toc').toc({
				title: '',
				listType: 'ul'
			});
		});
	</script>
</body>
</html>